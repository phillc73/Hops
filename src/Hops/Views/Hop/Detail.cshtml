@using Hops.Models;
@model HopModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    ViewBag.Title = $"{Model.Hop.Name} - Hops";
}

<div class="jumbotron">
    <button type="button" onclick="save();" class="btn btn-default pull-right">
        <span id="save" class="glyphicon glyphicon-star-empty" aria-hidden="true" aria-label="star"></span>
    </button>

    <h1>@Model.Hop.Name</h1>
    <p>@Model.Hop.Trade</p>
    <p>Aroma profile: @Model.Hop.Aroma</p>
    <p>Typical beer styles: @Model.Hop.Styles</p>
</div>

<div class="panel panel-default">
    <div class="panel-heading">Information</div>
    <div class="panel-body">
        <p>@Model.Hop.Info</p>
        @if(Model.Aliases.Any())
        {
            <p> Also known as: @string.Join(", ", Model.Aliases) </p>
        }      
        <p>Pedigree: @Model.Hop.Pedigree</p>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading">Brewing values</div>

    <div class="panel-body">
        Brewing Usage: @Model.Hop.BrewingUsageString()
    </div>

    <table class="table table-striped">
        <tr><td style="padding-left:15px;">Alpha Acid <span class="glyphicon glyphicon-info-sign" 
                                 data-toggle="tooltip" 
                                 title="Alpha acids are a major component of the soft resins. When isomerized, these materials provide the main bitter compaunds associated with beer." />
            </td><td>@Model.Hop.AlphaAcid()%</td>
        </tr>
        <tr><td style="padding-left:15px;">Beta Acid <span class="glyphicon glyphicon-info-sign"
                                data-toggle="tooltip"
                                title="Beta acids, another soft resin component, are not bitter in their natural, or isomeric, form. Some of the oxidation products do provide bitterness." />
            </td><td>@Model.Hop.BetaAcid()%</td>
        </tr>
        <tr><td style="padding-left:15px;">Co-humulone <span class="glyphicon glyphicon-info-sign"
                                  data-toggle="tooltip"
                                  title="It is widely held that higher levels of co-humulone produce a harsh, unpleasant bitterness and have a negative impact on head retention." />
            </td><td>@Model.Hop.CoHumulone()%</td>
        </tr>
        <tr><td style="padding-left:15px;">Total Oil <span class="glyphicon glyphicon-info-sign"
                                data-toggle="tooltip"
                                title="The quantity and composition of the essential oils are responsible for the amount and quality of hop flavor and aroma in beer." />
            </td><td>@Model.Hop.TotalOil() mL/100g</td>
        </tr>
    </table>
</div>

@if (Model.Substitutions.Any())
{
    <div class="panel panel-default">
        <div class="panel-heading">Possible substitutions</div>
        <div class="list-group">
            @foreach (var substitute in Model.Substitutions)
            {
                <a href="@Url.Action("Detail", new { Id = substitute.Id })" class="list-group-item">@substitute.Name</a>
            }
        </div>
    </div>
}

<div class="well">
    <a href="mailto:hops@curleezme.nl?subject=Hops - Suggested edit - @Model.Hop.Name">Suggest an edit</a>
</div>

<script>
$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
    loadSaveState();
});

function save() {
    var hopInv = [];

    var store = localStorage.getItem("hopInv");
    if (store !== null) {
        hopInv = JSON.parse(store);
    }

    var foundAtIndex = $.inArray(@Model.Hop.Id, hopInv);

    if (foundAtIndex > -1) {
        hopInv.splice(foundAtIndex, 1);
    } else {
        hopInv.push(@Model.Hop.Id);
    }

    $("#save").toggleClass("glyphicon-star glyphicon-star-empty");

    localStorage.setItem("hopInv", JSON.stringify(hopInv));
}

function loadSaveState() {
    var hopInv = [];

    var store = localStorage.getItem("hopInv");
    if (store !== null) {
        hopInv = JSON.parse(store);
    }

    var foundAtIndex = $.inArray(@Model.Hop.Id, hopInv);

    if (foundAtIndex > -1) {
        $("#save").toggleClass("glyphicon-star glyphicon-star-empty");
    }
}
</script>